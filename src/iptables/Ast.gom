module iptables.Ast
imports String int
abstract syntax

	Rules = rules(Rule*)

	Rule = rule(
			action:Action,
			srcAddr:Address,
			destAddr:Address,
			srcPort:Port,
			destPort:Port)

	Action =
		Accept()
		| Drop()

	Address =
		Addr(ip:int,smask:int)
		| AddrAny()

	Port =
		Port(number:int)
		| PortAny()
